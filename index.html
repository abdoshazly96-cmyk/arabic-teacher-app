<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق البيان - النسخة المتكاملة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Sans+Arabic:wght@300;400;700&display=swap');
        body { font-family: 'Noto Sans Arabic', sans-serif; background-color: #f8fafc; }
        .font-serif { font-family: 'Amiri', serif; }
        .word-btn:hover { background-color: #eef2ff; color: #4f46e5; border-radius: 6px; }
        .active-word { color: #4f46e5; font-weight: bold; border-bottom: 3px solid #818cf8; }
        /* تحسينات للشاشات الصغيرة */
        @media (max-width: 768px) {
            .main-layout { flex-direction: column; }
            .sidebar { width: 100% !important; height: auto !important; order: 2; }
            .content { order: 1; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // قاعدة بيانات تعليمية مدمجة (لا تحتاج مفتاح API)
        const dictionary = {
            "العربية": { trans: "Arabic", desc: "لغة عالمية سامية، وهي لغة القرآن الكريم.", ex: "اللغة العربية بحر من الكلمات." },
            "لغة": { trans: "Language", desc: "نسق من الرموز والإشارات يستخدم للتواصل بين البشر.", ex: "كل شعب له لغة تميزه." },
            "عريقة": { trans: "Ancient/Noble", desc: "شيء له جذور تاريخية قديمة وأصيلة.", ex: "مصر تمتلك حضارة عريقة." },
            "جميلة": { trans: "Beautiful", desc: "وصف للشيء الذي يبعث البهجة والسرور في النفس.", ex: "الوردة جميلة الرائحة." },
            "تمتاز": { trans: "Distinguished", desc: "الاتصاف بخصائص تجعل الشيء متفوقاً أو مختلفاً.", ex: "تمتاز الجمال بالصبر." },
            "ببلاغتها": { trans: "Eloquence", desc: "القدرة على إيصال المعنى بوضوح وتأثير عالٍ.", ex: "اشتهر شعراء العرب ببلاغتهم." },
            "اتساع": { trans: "Vastness", desc: "كبر الحجم أو رحابة المحتوى والمساحة.", ex: "يدهشنا اتساع الفضاء." },
            "مفرداتها": { trans: "Vocabulary", desc: "مجموعة الكلمات التي تتركب منها اللغة.", ex: "يجب إثراء مفرداتك اللغوية." }
        };

        const App = () => {
            const [view, setView] = useState('reader');
            const [selected, setSelected] = useState(null);
            const [saved, setSaved] = useState([]);
            const [score, setScore] = useState(0);

            const text = "العَرَبِيَّةُ لُغَةٌ عَرِيقَةٌ وَجَمِيلَةٌ، تَمْتَازُ بِبَلَاغَتِهَا وَاتِّسَاعِ مُفْرَدَاتِهَا.";

            // وظيفة الصوت (تستخدم محرك المتصفح الداخلي)
            const playSound = (txt) => {
                window.speechSynthesis.cancel();
                const speech = new SpeechSynthesisUtterance(txt);
                speech.lang = 'ar-SA';
                speech.rate = 0.85;
                window.speechSynthesis.speak(speech);
            };

            const handleSelect = (word) => {
                const clean = word.replace(/[^\u0621-\u064A]/g, '');
                setSelected(clean);
                const info = dictionary[clean];
                if (info && !saved.find(i => i.word === clean)) {
                    setSaved([...saved, { word: clean, ...info }]);
                }
            };

            return (
                <div className="flex flex-col md:flex-row h-screen overflow-hidden main-layout">
                    {/* القائمة الجانبية للتنقل */}
                    <nav className="w-full md:w-20 bg-slate-900 text-white flex md:flex-col items-center py-4 md:py-8 space-x-6 md:space-x-0 md:space-y-10 justify-center md:justify-start">
                        <div className="text-2xl font-bold bg-indigo-600 w-12 h-12 flex items-center justify-center rounded-xl shadow-lg">ب</div>
                        <button onClick={() => setView('reader')} className={`p-3 rounded-xl transition ${view === 'reader' ? 'bg-indigo-600' : 'opacity-40'}`}><i data-lucide="book-open"></i></button>
                        <button onClick={() => setView('dict')} className={`p-3 rounded-xl transition ${view === 'dict' ? 'bg-indigo-600' : 'opacity-40'}`}><i data-lucide="languages"></i></button>
                        <button onClick={() => setView('quiz')} className={`p-3 rounded-xl transition ${view === 'quiz' ? 'bg-indigo-600' : 'opacity-40'}`}><i data-lucide="brain"></i></button>
                    </nav>

                    {/* المحتوى الرئيسي */}
                    <div className="flex-1 flex flex-col bg-slate-50 overflow-hidden content">
                        <header className="h-16 bg-white border-b flex items-center justify-between px-6 shadow-sm">
                            <h1 className="font-bold text-slate-800">البيان لتعلم العربية</h1>
                            <div className="text-xs font-bold bg-green-100 text-green-700 px-3 py-1 rounded-full">النسخة المتكاملة (بدون مفتاح)</div>
                        </header>

                        <main className="flex-1 overflow-y-auto p-4 md:p-10">
                            {view === 'reader' && (
                                <div className="max-w-3xl mx-auto space-y-6">
                                    <button onClick={() => playSound(text)} className="flex items-center gap-2 bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold shadow-lg hover:bg-indigo-700 active:scale-95 transition">
                                        <i data-lucide="play"></i> استماع للنص كاملاً
                                    </button>
                                    <div className="bg-white p-10 rounded-[2rem] shadow-xl border border-slate-100">
                                        <p className="text-3xl md:text-4xl leading-[2.5] font-serif text-slate-800">
                                            {text.split(' ').map((w, i) => (
                                                <span key={i} onClick={() => handleSelect(w)} className={`cursor-pointer word-btn px-1 transition ${selected === w.replace(/[^\u0621-\u064A]/g, '') ? 'active-word' : ''}`}>
                                                    {w}{' '}
                                                </span>
                                            ))}
                                        </p>
                                    </div>
                                </div>
                            )}

                            {view === 'dict' && (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-4xl mx-auto">
                                    {saved.length === 0 ? (
                                        <div className="col-span-full py-20 text-center text-slate-400 font-bold border-2 border-dashed rounded-2xl">اضغط على الكلمات في القارئ لتراها هنا.</div>
                                    ) : saved.map((w, i) => (
                                        <div key={i} className="bg-white p-6 rounded-2xl border shadow-sm flex justify-between group">
                                            <div>
                                                <h3 className="text-2xl font-bold font-serif text-slate-900">{w.word}</h3>
                                                <p className="text-indigo-600 font-bold mb-2">Translation: {w.trans}</p>
                                                <p className="text-sm text-slate-500">{w.desc}</p>
                                            </div>
                                            <button onClick={() => playSound(w.word)} className="p-2 text-indigo-500 hover:bg-indigo-50 rounded-full"><i data-lucide="volume-2"></i></button>
                                        </div>
                                    ))}
                                </div>
                            )}

                            {view === 'quiz' && (
                                <div className="max-w-md mx-auto bg-white p-8 rounded-3xl shadow-xl border text-center">
                                    <h2 className="text-2xl font-bold mb-6">اختبر نفسك</h2>
                                    <p className="mb-6 font-bold text-slate-600">ما معنى كلمة "عريقة"؟</p>
                                    <div className="space-y-3">
                                        {["Ancient", "New", "Fast"].map((o, i) => (
                                            <button key={i} onClick={() => {if(i===0){setScore(score+1); alert("صحيح!");} else alert("خطأ!");}} className="w-full p-4 border rounded-xl hover:bg-indigo-50 font-bold transition">{o}</button>
                                        ))}
                                    </div>
                                    <div className="mt-8 text-indigo-600 font-bold">نقاطك: {score}</div>
                                </div>
                            )}
                        </main>
                    </div>

                    {/* اللوحة الجانبية (شرح الكلمة) */}
                    <aside className="w-full md:w-80 bg-white border-r shadow-2xl p-6 overflow-y-auto sidebar">
                        {selected && dictionary[selected] ? (
                            <div className="space-y-6">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-4xl font-bold font-serif text-slate-900">{selected}</h2>
                                    <button onClick={() => playSound(selected)} className="p-3 bg-indigo-50 text-indigo-600 rounded-full"><i data-lucide="volume-2"></i></button>
                                </div>
                                <div className="bg-indigo-600 text-white p-4 rounded-2xl">
                                    <p className="text-[10px] font-bold opacity-60 uppercase">Translation</p>
                                    <p className="text-2xl font-bold">{dictionary[selected].trans}</p>
                                </div>
                                <div className="bg-amber-50 p-4 rounded-2xl border-r-4 border-amber-400">
                                    <p className="text-xs font-bold text-amber-700 mb-1">الشرح</p>
                                    <p className="text-slate-700">{dictionary[selected].desc}</p>
                                </div>
                                <div className="bg-slate-50 p-4 rounded-2xl border">
                                    <p className="text-xs font-bold text-slate-400 mb-1">مثال</p>
                                    <p className="italic font-serif text-slate-600">"{dictionary[selected].ex}"</p>
                                </div>
                            </div>
                        ) : (
                            <div className="h-full flex flex-col items-center justify-center text-slate-300 opacity-50">
                                <i data-lucide="mouse-pointer-2" className="w-12 h-12 mb-4"></i>
                                <p>اضغط على كلمة للتحليل</p>
                            </div>
                        )}
                    </aside>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
        setTimeout(() => lucide.createIcons(), 500);
    </script>
</body>
</html>
